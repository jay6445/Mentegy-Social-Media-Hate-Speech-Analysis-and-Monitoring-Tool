<!--

=========================================================
* Argon Dashboard - v1.1.0
=========================================================

* Product Page: https://www.creative-tim.com/product/argon-dashboard
* Copyright 2019 Creative Tim (https://www.creative-tim.com)
* Licensed under MIT (https://github.com/creativetimofficial/argon-dashboard/blob/master/LICENSE.md)

* Coded by Creative Tim

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. -->
<!DOCTYPE html>
<html lang="en">

<!-- Static assets - Used to load the Favicon -->
{% load static %}

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>
    Mentegy
  </title>

  <!-- Favicon - loaded as static -->
  <link href="{% static 'assets/img/brand/Mentegy Logo.png' %}" rel="icon" type="image/png">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">
  <!-- Icons -->
  <link href="/static/assets/js/plugins/nucleo/css/nucleo.css" rel="stylesheet" />
  <link href="/static/assets/js/plugins/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet" />
  <!-- CSS Files -->
  <link href="/static/assets/css/argon-dashboard.css?v=1.2.1" rel="stylesheet" />

  <!-- Specific CSS goes HERE -->
  {% block stylesheets %}{% endblock stylesheets %}

</head>

<body class="">

  {% include "includes/sidenav.html" %}

  <div class="main-content">

    {% include "includes/navigation.html" %}

    {% block content %}{% endblock content %}

  </div>

  {% include "includes/scripts.html" %}

  <!-- Specific JS goes HERE -->
  {% block javascripts %}{% endblock javascripts %}

</body>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://momentjs.com/downloads/moment.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
<script>


  function livescores() {

    var $scoreChart = $("#score-chart");
    $.ajax({
      url: $scoreChart.data("url"),
      success: function (data) {

        var ctx = $scoreChart[0].getContext("2d");
        var gradientFill = ctx.createLinearGradient(0, 0, 0, 290);
        gradientFill.addColorStop(0, "rgba(0, 255, 218, 1)");
        gradientFill.addColorStop(1, "rgba(0, 255, 218, 0.1)");
        new Chart(ctx, {
          type: 'line',
          data: {
            labels: data.labels,
            datasets: [{
              label: 'Sentiment Score',

              data: data.data,
              backgroundColor: gradientFill,
              borderColor: [
                'rgba(0, 255, 218, 1)',
              ],
              borderWidth: 2,
              pointBorderColor: "#fff",
              pointBackgroundColor: "rgba(0, 255, 218, 1)"
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            legend: {
              position: 'top',
            },
            title: {
              display: true,
              text: 'Live Sentiment Chart'
            },

          }
        });

      }
    });

  };



  function dailyavgscores() {

    var $dailyavgChart = $("#daily-avg-chart");
    

    $.ajax({
      url: $dailyavgChart.data("url"),
      success: function (data) {

        var ctx = $dailyavgChart[0].getContext("2d");
        var gradientFill = ctx.createLinearGradient(0, 0, 0, 290);
        gradientFill.addColorStop(0, "rgba(0, 255, 218, 1)");
        gradientFill.addColorStop(1, "rgba(0, 255, 218, 0.1)");
        new Chart(ctx, {
          type: 'bar',
          data: {
            labels: data.labels,
            datasets: [{
              label: 'Sentiment Score',

              data: data.data,
              backgroundColor: gradientFill,
              borderColor: [
                'rgba(0, 255, 218, 1)',
              ],
              borderWidth: 2,
              pointBorderColor: "#fff",
              pointBackgroundColor: "rgba(0, 255, 218, 1)"
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            legend: {
              position: 'top',
            },
            scales: {
              xAxes: [{
                display: true,

                scaleLabel: {
                  display: true,
                  labelString: 'Day'
                }
              }],
              yAxes: [{
                display: true,

                scaleLabel: {
                  display: true,
                  labelString: 'Score'
                }
              }]
            },
            title: {
              display: true,
              text: 'Live Sentiment Chart'
            },

          }
        });

      }
    });

  };

  function totalavgscores() {

    var $totalAvgChart = $("#total-avg-chart");
    $.ajax({
      url: $totalAvgChart.data("url"),
      success: function (data) {

        var ctx = $totalAvgChart[0].getContext("2d");
        var gradientFill = ctx.createLinearGradient(0, 0, 0, 290);
        gradientFill.addColorStop(0, "rgba(0, 255, 218, 1)");
        gradientFill.addColorStop(1, "rgba(0, 255, 218, 0.1)");
        new Chart(ctx, {
          type: 'bar',
          data: {
            labels: data.labels,
            datasets: [{
              label: 'Sentiment Score Today',

              data: data.data,
              backgroundColor: gradientFill,
              borderColor: [
                'rgba(0, 255, 218, 1)',
              ],

              borderWidth: 2,
              pointBorderColor: "#fff",
              pointBackgroundColor: "rgba(0, 255, 218, 1)"

            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            legend: {
              position: 'top',
            },
        
            title: {
              display: true,
              text: 'Live Sentiment Chart'
            },

          }
        });

      }
    });

  };

  function totalcount() {

    var $totalCountChart = $("#total-count-chart");
    $.ajax({
      url: $totalCountChart.data("url"),
      success: function (data) {

        var ctx = $totalCountChart[0].getContext("2d");
        var gradientFill = ctx.createLinearGradient(0, 0, 0, 290);
        gradientFill.addColorStop(0, "rgba(0, 255, 218, 1)");
        gradientFill.addColorStop(1, "rgba(0, 255, 218, 0.1)");
        new Chart(ctx, {
          type: 'line',
          data: {
            labels: data.labels,
            datasets: [{
              label: 'Sentiment Score Today',

              data: data.data,
              backgroundColor: gradientFill,
              borderColor: [
                'rgba(0, 255, 218, 1)',
              ],

              borderWidth: 2,
              pointBorderColor: "#fff",
              pointBackgroundColor: "rgba(0, 255, 218, 1)"

            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            legend: {
              position: 'top',
            },
       
            title: {
              display: true,
              text: 'Live Sentiment Chart'
            },

          }
        });

      }
    });

  };



  $(document).ready(function () {
    livescores();
    totalavgscores();
    totalcount();
    dailyavgscores();
    setInterval(livescores, 3000);
    setInterval(totalavgscores, 10000);
    setInterval(dailyavgscores, 10000);
    setInterval(totalcount, 10000);
    //$('.chart').css('height', 'auto')

  });

  function golive(ref) {
    var bclass = $(ref).attr('class');

    if (bclass == 'notlive') {

      $('#sidenav-main').detach();
      var start = setInterval(livescores, 2000);
      $(ref).css('background-color', 'red');
      $(ref).html('Stop')
      $(ref).attr('class', 'live');
      console.log(ref);
    }
    else if (bclass == 'live') {
      setTimeout(golive); //stop the set interval
      $(ref).html('Go Live');
      $(ref).attr('class', 'notlive');
      console.log(ref);
    }


  }


</script>

</html>